name: aye-chef

services:
  web:
    build: .
    container_name: aye-chef-web
    command: web
    ports:
      - "8080:8080"
    volumes:
      - .:/app  # Mount entire source for development
      - /app/__pycache__  # Exclude pycache
      - /app/.git  # Exclude git
    environment:
      - PYTHONUNBUFFERED=1
      # Optional: Override credentials via env vars instead of web UI
      # - MEALIE_TOKEN=your_token_here
      # - OPENROUTER_API_KEY=your_key_here
    depends_on:
      - worker
    restart: unless-stopped

  worker:
    build: .
    container_name: aye-chef-worker
    command: worker
    volumes:
      - .:/app  # Mount entire source for development
      - /app/__pycache__  # Exclude pycache
      - /app/.git  # Exclude git
      - huggingface_cache:/root/.cache/huggingface
    environment:
      - PYTHONUNBUFFERED=1
      # Optional: Override credentials via env vars instead of web UI
      # - MEALIE_TOKEN=your_token_here
      # - OPENROUTER_API_KEY=your_key_here
    restart: unless-stopped

volumes:
  huggingface_cache:
